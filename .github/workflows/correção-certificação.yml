name: Corre√ß√£o e Certifica√ß√£o
on: [pull_request]
jobs:
  Codaqui:
    runs-on: ubuntu-latest
    steps:
      - name: BoasVindas
        run: |
          echo "üéâ Muito legal, voc√™ est√° tentando realizar a certifica√ß√£o de Python da Codaqui!"
          echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
          echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."

      - name: Check out repository code
        uses: actions/checkout@v2   
        
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      
      - name: "‚öôÔ∏è Configurando verifica√ß√£o autom√°tica de certificado..."
        run: |
          pip3 install pytest
          python -m pytest tests/test_config.py
    
      - name: "Projeto 1 - Hello World!"
        run: |
          hello_world_output=$(python submission/projeto1/main.py)
          if [ "$hello_world_output" != "Hello World!" ]; then
              echo "‚ùå Ocorreu um erro, n√£o conseguimos identificar o Hello World!";
              exit 1;
          else
              echo "‚úîÔ∏è Esta atividade est√° aprovada!";
          fi
          
      - name: "Projeto 2 - Tipos e Vari√°veis"
        run: |
          python -m pytest tests/test_projeto2.py
          
      - name: "Projeto 3 - Listas e Cole√ß√µes"
        run: |
          python -m pytest tests/test_projeto3.py
          
      - uses: actions/github-script@v6
        name: ‚ö†Ô∏è Aten√ß√£o - Avaliador 
        with:
          script: |
          
            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: '‚ö†Ô∏è Aten√ß√£o Revisor! 
              \n Os seguintes exercicios devem ser corrigidos manualmente:
              \n - Projeto 3 - Exercicio 2.
              '
            })
